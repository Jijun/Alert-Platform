#!/usr/bin/python3
# -*- coding: utf-8 -*-

#@author: PI

import sys
import base64
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email import encoders
import idna

def base64_decode(param):
    param = bytes(param, encoding="utf-8");
    param = base64.b64decode(param).decode("utf-8")
    return param;

def punycode_converter(param):
    param = param.split("@")
    return idna.encode(param[0]).decode("utf-8") + "@" + idna.encode(param[1]).decode("utf-8")

def send_email(to, subject, body):
# THIS FUNCTION SUPPORTS SMTPUTF8 (receiver's email address contains UTF-8 characters); you need a SMTP server which supports SMTPUTF8 to enable this feature, however.
    user = "example@example.com"
    email_password = "blahblah"
    smtp_server = "SMTP.locahost"
    smtp_port = 587

    msg = MIMEMultipart()

    msg['From'] = user
    msg['Subject'] = base64_decode(subject)

    default_body_head = '<div style="width:78.7%;margin:auto;font-size:14px;font-family:Times New Roman,Times,STFangsong,Microsoft YaHei,黑体,宋体"><div style="padding:28px 12px;display:block;height:auto;text-align:justify;background:#f9f5a9;color:#1082a5;width:100%;border:3px solid #898989;-webkit-border-radius:22px;-moz-border-radius:22px;border-radius:22px;-webkit-box-shadow:0 0 20px rgba(0,0,0,.32);-moz-box-shadow:0 0 20px rgba(0,0,0,.32);box-shadow:0 0 20px rgba(0,0,0,.32)"><!--This system is designed by Mike in Beiing. Copyright 2019 Mike. All rights reserved.--><a href="https://github.com/Pi-314159265" target="_blank"><img src="data:image/png;base64,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" alt="Alert Platform" style="width:72px;height:72px;display:block;margin:auto"></a><br>'
    default_body_foot = '<br><hr><div style="text-align:center"><p><strong>这是一封自动产生的邮件，<span style="color:#FF0000;">请勿回复</span>。</strong></p><p><strong>THIS IS AN AUTOMATED MESSAGE, PLEASE <span style="color:#FF0000;">DO NOT REPLY</span> TO THIS EMAIL.</strong></p><p style="font-size: 14px;"><strong>免责声明 | CONFIDENTIALITY NOTICE</strong></p></div><p>该电子邮件中的信息是保密的，除收件人外任何人无权访问此电子邮件。如果您不是收件人，请立即删除本邮件及附件；任何公开、复制、分发或基于此封邮件的行动，都是禁止的，并可能是违法的。</p><p>The contents of this email message and any attachments are intended solely for the addressee(s) and may contain confidential and/or privileged information and may be legally protected from disclosure. If you are not the intended recipient of this message or their agent, or if this message has been addressed to you in error, please immediately delete this message and any attachments. If you are not the intended recipient, you are hereby notified that any use, dissemination, copying, or storage of this message or its attachments is strictly prohibited.</p></div></div>'
    msg.attach(MIMEText(default_body_head + base64_decode(body) + default_body_foot, 'html'))

    server = smtplib.SMTP(smtp_server, smtp_port)
    server.starttls()
#    server = smtplib.SMTP_SSL(smtp_server + ":" + str(smtp_port)) # In case you need SSL/TLS auth.
    server.login(user, email_password)

    try:
        msg['To'] = base64_decode(to)
        text = msg.as_string()
        server.sendmail(user, base64_decode(to), text, mail_options=['SMTPUTF8'])
    except smtplib.SMTPNotSupportedError:
        msg['To'] = punycode_converter(base64_decode(to))
        text = msg.as_string()
        server.sendmail(user, punycode_converter(base64_decode(to)), text)

    server.quit()

send_email(sys.argv[1], sys.argv[2], sys.argv[3])
print("Success!", end ="")
